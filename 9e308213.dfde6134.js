(window.webpackJsonp=window.webpackJsonp||[]).push([[59],{130:function(e,a,t){"use strict";t.r(a),t.d(a,"frontMatter",(function(){return r})),t.d(a,"metadata",(function(){return l})),t.d(a,"rightToc",(function(){return b})),t.d(a,"default",(function(){return d}));var n=t(3),o=t(7),i=(t(0),t(165)),r={title:"Azkaban Flows and Jobs",hide_title:!0,slug:"/rfc/active/1820-azkaban-flow-job",custom_edit_url:"https://github.com/linkedin/datahub/blob/master/docs/rfc/active/1820-azkaban-flow-job/README.md"},l={unversionedId:"docs/rfc/active/1820-azkaban-flow-job/README",id:"docs/rfc/active/1820-azkaban-flow-job/README",isDocsHomePage:!1,title:"Azkaban Flows and Jobs",description:"- Start Date: 2020-08-25",source:"@site/genDocs/docs/rfc/active/1820-azkaban-flow-job/README.md",slug:"/rfc/active/1820-azkaban-flow-job",permalink:"/docs/rfc/active/1820-azkaban-flow-job",editUrl:"https://github.com/linkedin/datahub/blob/master/docs/rfc/active/1820-azkaban-flow-job/README.md",version:"current",sidebar:"overviewSidebar",previous:{title:"Machine Learning Models",permalink:"/docs/rfc/active/1812-ml_models"},next:{title:"RFC - Field Level Lineage",permalink:"/docs/rfc/active/1841-lineage/field_level_lineage"}},b=[{value:"Summary",id:"summary",children:[]},{value:"Motivation",id:"motivation",children:[]},{value:"Requirements",id:"requirements",children:[]},{value:"Non Requirements",id:"non-requirements",children:[]},{value:"Detailed design",id:"detailed-design",children:[{value:"Entities",id:"entities",children:[]},{value:"URN Representation",id:"urn-representation",children:[]},{value:"Azkaban Flow metadata",id:"azkaban-flow-metadata",children:[]},{value:"Azkaban Job metadata",id:"azkaban-job-metadata",children:[]}]},{value:"Rollout / Adoption Strategy",id:"rollout--adoption-strategy",children:[]},{value:"Future Work",id:"future-work",children:[]}],s={rightToc:b};function d(e){var a=e.components,r=Object(o.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},s,r,{components:a,mdxType:"MDXLayout"}),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Start Date: 2020-08-25"),Object(i.b)("li",{parentName:"ul"},"RFC PR: ",Object(i.b)("a",{parentName:"li",href:"https://github.com/linkedin/datahub/pull/1820"},"https://github.com/linkedin/datahub/pull/1820")),Object(i.b)("li",{parentName:"ul"},"Implementation PR(s): ",Object(i.b)("a",{parentName:"li",href:"https://github.com/linkedin/datahub/pull/1732"},"https://github.com/linkedin/datahub/pull/1732"))),Object(i.b)("h1",{id:"azkaban-flows-and-jobs"},"Azkaban Flows and Jobs"),Object(i.b)("h2",{id:"summary"},"Summary"),Object(i.b)("p",null,"Adding support for ",Object(i.b)("a",{parentName:"p",href:"https://azkaban.github.io/"},"Azkaban")," job and flow metadata and enabling search and discovery for them. "),Object(i.b)("p",null,"The design includes the metadata needed to represent Azkaban jobs and flows as data job entities and their relationships to other\nentities like Datasets."),Object(i.b)("h2",{id:"motivation"},"Motivation"),Object(i.b)("p",null,"Azkaban is a popular open source workflow manager created and extensively used at LinkedIn. Azkaban metadata is a critical piece\nin the metadata graph since data processing jobs are the primary driver of data movement and creation."),Object(i.b)("p",null,"Without job metadata, it is not possible to understand the data flow across an organization. Additionally, jobs are needed in the\nlineage graph to surface operational metadata and have a complete view of data movement and processing. Capturing jobs and flows\nmetadata in the lineage graph also allows in understanding dependency between multiple flows and jobs and structure of data\npipelines in end to end data flow."),Object(i.b)("h2",{id:"requirements"},"Requirements"),Object(i.b)("p",null,"The following requirements exists as part of this rfc:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Define Data flow and job as entities and model metadata for azkaban data job and flows"),Object(i.b)("li",{parentName:"ul"},"Enable Search & Discovery for Data jobs and flows"),Object(i.b)("li",{parentName:"ul"},"Link DataJob entities to existing entities like Datasets to build a more complete metadata graph"),Object(i.b)("li",{parentName:"ul"},"Automatically derive dataset upstream lineage from data job metadata (inputs and outputs)")),Object(i.b)("h2",{id:"non-requirements"},"Non Requirements"),Object(i.b)("p",null,"Azkaban has its own application to surface jobs, flows, operational metadata and job logs. DataHub doesn't intend to be\na replacement for it. Users will still need to go to Azkaban UI to look at logs and debug issues. DataHub will only show\nimportant and high level metadata in the context of search, discovery and exploration including lineage and will link to\nAzkaban UI for further debugging or finer grained information."),Object(i.b)("h2",{id:"detailed-design"},"Detailed design"),Object(i.b)("p",null,Object(i.b)("img",{alt:"high level design",src:t(254).default})),Object(i.b)("p",null,"The graph diagram above shows the relationships and high level metadata associated with Data Job and Flow entities."),Object(i.b)("p",null,"An Azkaban flow is a DAG of one or more Azkaban jobs. Usually, most data processing jobs consume one or more inputs and\nproduce one of more outputs (represented by datasets in the diagram). There can be other kinds of housekeeping jobs as well\nlike cleanup jobs which don't have any data processing involved."),Object(i.b)("p",null,"In the diagram above, the Azkaban job node consumes datasets ",Object(i.b)("inlineCode",{parentName:"p"},"ds1")," and ",Object(i.b)("inlineCode",{parentName:"p"},"ds2")," and produces ",Object(i.b)("inlineCode",{parentName:"p"},"ds3"),". It is also linked to the\nflow it is part of. As shown in the diagram, dataset upstream lineage is derived from the azkaban job metadata which results\nin ",Object(i.b)("inlineCode",{parentName:"p"},"ds1")," and ",Object(i.b)("inlineCode",{parentName:"p"},"ds2")," being upstreams of ",Object(i.b)("inlineCode",{parentName:"p"},"ds3"),"."),Object(i.b)("h3",{id:"entities"},"Entities"),Object(i.b)("p",null,"There will be 2 top level GMA ",Object(i.b)("a",{parentName:"p",href:"/docs/what/entity"},"entities")," in the design: DataJob and DataFlow."),Object(i.b)("h3",{id:"urn-representation"},"URN Representation"),Object(i.b)("p",null,"We'll define two ",Object(i.b)("a",{parentName:"p",href:"/docs/what/urn"},"URNs"),": ",Object(i.b)("inlineCode",{parentName:"p"},"DataJobUrn")," and ",Object(i.b)("inlineCode",{parentName:"p"},"DataFlowUrn"),".\nThese URNs should allow for unique identification for a Data job and flow respectively."),Object(i.b)("p",null,"DataFlow URN will consist of the following parts:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Workflow manager type (e.g. azkaban, airflow etc)"),Object(i.b)("li",{parentName:"ol"},"Flow id - Id of a flow unique within a cluster"),Object(i.b)("li",{parentName:"ol"},"Cluster - Cluster where the flow is deployed/executed")),Object(i.b)("p",null,"DataJob URN will consist of the following parts:"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Flow Urn - Urn of the data flow this job is part of"),Object(i.b)("li",{parentName:"ol"},"Job id - Unique id of the job within the flow")),Object(i.b)("p",null,"An example DataFlow URN will look like below:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"urn:li:dataFlow:(azkaban,flow_id,cluster)\n")),Object(i.b)("p",null,"An example DataJob URN will look like below:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"urn:li:dataJob:(urn:li:dataFlow:(azkaban,flow_id,cluster),job_id)\n")),Object(i.b)("h3",{id:"azkaban-flow-metadata"},"Azkaban Flow metadata"),Object(i.b)("p",null,"Below is a list of metadata which can be associated with an azkaban flow:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Project for the flow (the concept of project may not exist for other workflow managers so it may not apply in all cases)"),Object(i.b)("li",{parentName:"ul"},"Flow name"),Object(i.b)("li",{parentName:"ul"},"Ownership")),Object(i.b)("h3",{id:"azkaban-job-metadata"},"Azkaban Job metadata"),Object(i.b)("p",null,"Below is a list of metadata which can be associated with an azkaban job:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Job name"),Object(i.b)("li",{parentName:"ul"},"Job type (could be spark, mapreduce, hive, presto. command etc)"),Object(i.b)("li",{parentName:"ul"},"Inputs consumed by the job"),Object(i.b)("li",{parentName:"ul"},"Outputs produced by the job")),Object(i.b)("h2",{id:"rollout--adoption-strategy"},"Rollout / Adoption Strategy"),Object(i.b)("p",null,"The design references open source Azkaban so it is adoptable by anyone using Azkaban as their\nworkflow manager."),Object(i.b)("h2",{id:"future-work"},"Future Work"),Object(i.b)("ol",null,Object(i.b)("li",{parentName:"ol"},"Adding operational metadata associated with Azkaban entities"),Object(i.b)("li",{parentName:"ol"},"Adding azkaban references in Upstream lineage so that the jobs show up in the lineage graph")))}d.isMDXComponent=!0},165:function(e,a,t){"use strict";t.d(a,"a",(function(){return c})),t.d(a,"b",(function(){return m}));var n=t(0),o=t.n(n);function i(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function r(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,n)}return t}function l(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?r(Object(t),!0).forEach((function(a){i(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function b(e,a){if(null==e)return{};var t,n,o=function(e,a){if(null==e)return{};var t,n,o={},i=Object.keys(e);for(n=0;n<i.length;n++)t=i[n],a.indexOf(t)>=0||(o[t]=e[t]);return o}(e,a);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(o[t]=e[t])}return o}var s=o.a.createContext({}),d=function(e){var a=o.a.useContext(s),t=a;return e&&(t="function"==typeof e?e(a):l(l({},a),e)),t},c=function(e){var a=d(e.components);return o.a.createElement(s.Provider,{value:a},e.children)},u={inlineCode:"code",wrapper:function(e){var a=e.children;return o.a.createElement(o.a.Fragment,{},a)}},p=o.a.forwardRef((function(e,a){var t=e.components,n=e.mdxType,i=e.originalType,r=e.parentName,s=b(e,["components","mdxType","originalType","parentName"]),c=d(t),p=n,m=c["".concat(r,".").concat(p)]||c[p]||u[p]||i;return t?o.a.createElement(m,l(l({ref:a},s),{},{components:t})):o.a.createElement(m,l({ref:a},s))}));function m(e,a){var t=arguments,n=a&&a.mdxType;if("string"==typeof e||n){var i=t.length,r=new Array(i);r[0]=p;var l={};for(var b in a)hasOwnProperty.call(a,b)&&(l[b]=a[b]);l.originalType=e,l.mdxType="string"==typeof e?e:n,r[1]=l;for(var s=2;s<i;s++)r[s]=t[s];return o.a.createElement.apply(null,r)}return o.a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},254:function(e,a,t){"use strict";t.r(a),a.default=t.p+"assets/images/graph-ff33413b390f0a17ab55c1c96bc7677e.png"}}]);