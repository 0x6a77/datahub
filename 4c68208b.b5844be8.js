(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{101:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return s})),a.d(t,"rightToc",(function(){return c})),a.d(t,"default",(function(){return p}));var n=a(159),r=a(160),o=(a(0),a(161)),i={title:"What is MXE (Metadata Events)?",hide_title:!0,slug:"/what/mxe",custom_edit_url:"https://github.com/linkedin/datahub/blob/master/docs/what/mxe.md"},s={unversionedId:"docs/what/mxe",id:"docs/what/mxe",isDocsHomePage:!1,title:"What is MXE (Metadata Events)?",description:"What is MXE (Metadata Events)?",source:"@site/genDocs/docs/what/mxe.md",slug:"/what/mxe",permalink:"/docs/what/mxe",editUrl:"https://github.com/linkedin/datahub/blob/master/docs/what/mxe.md",version:"current",sidebar:"overviewSidebar",previous:{title:"What is a metadata delta?",permalink:"/docs/what/delta"},next:{title:"Developer's Guide",permalink:"/docs/developers"}},c=[{value:"Metadata Change Event (MCE)",id:"metadata-change-event-mce",children:[]},{value:"Metadata Audit Event (MAE)",id:"metadata-audit-event-mae",children:[]}],d={rightToc:c};function p(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},d,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h1",{id:"what-is-mxe-metadata-events"},"What is MXE (Metadata Events)?"),Object(o.b)("p",null,"The models defined in ",Object(o.b)("a",{parentName:"p",href:"/docs/what/snapshot"},"snapshot")," and ",Object(o.b)("a",{parentName:"p",href:"/docs/what/delta"},"delta")," are used to build the schema for several metadata Kafka events. As these events have the prefix ",Object(o.b)("inlineCode",{parentName:"p"},"Metadata")," and suffix ",Object(o.b)("inlineCode",{parentName:"p"},"Event"),", they\u2019re collectively referred to as MXE."),Object(o.b)("p",null,"We also model MXEs using ",Object(o.b)("a",{parentName:"p",href:"https://linkedin.github.io/rest.li/pdl_schema"},"PDL")," and rely on the ",Object(o.b)("a",{parentName:"p",href:"https://linkedin.github.io/rest.li/setup/gradle#generateavroschema"},"pegasus gradle plugin")," to convert them into ",Object(o.b)("a",{parentName:"p",href:"https://avro.apache.org/docs/current/spec.html"},"AVSC"),". However, we also need to rename all the namespaces of the generated AVSC to avoid namespace clashes for projects that depend on both the PDL models and MXEs. "),Object(o.b)("p",null,"As the AVSC and PDL model schemas are 100% compatible, it\u2019d be very easy to convert the in-memory representation from one to another using ",Object(o.b)("a",{parentName:"p",href:"https://linkedin.github.io/rest.li/DATA-Data-Schema-and-Templates#translating-data-to-and-from-avro"},"Pegasus\u2019 DataTranslator"),"."),Object(o.b)("h2",{id:"metadata-change-event-mce"},"Metadata Change Event (MCE)"),Object(o.b)("p",null,'MCE is a "proposal" for a metadata change, as opposed to ',Object(o.b)("a",{parentName:"p",href:"#metadata-audit-event"},"MAE"),", which is conveying a committed change.\nConsequently, only successfully accepted and processed MCEs will lead to the emission of a corresponding MAE.\nA single MCE can contain both snapshot-oriented and delta-oriented metadata change proposal. The use case of this event is explained in ",Object(o.b)("a",{parentName:"p",href:"/docs/architecture/metadata-ingestion"},"Metadata Ingestion"),"."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},"namespace com.linkedin.mxe\n\nimport com.linkedin.avro2pegasus.events.KafkaAuditHeader\nimport com.linkedin.metadata.delta.Delta\nimport com.linkedin.metadata.snapshot.Snapshot\n\n/**\n * Kafka event for proposing a metadata change for an entity\n */\nrecord MetadataChangeEvent {\n\n  /** Kafka audit header */\n  auditHeader: optional KafkaAuditHeader\n\n  /** Snapshot of the proposed metadata change. Include only the aspects affected by the change in the snapshot. */\n  proposedSnapshot: Snapshot\n\n  /** Delta of the proposed metadata partial update */\n  proposedDelta: optional Delta\n}\n")),Object(o.b)("p",null,"We\u2019ll also generate a ",Object(o.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Dead_letter_queue"},"dead letter queue")," event, Failed Metadata Change Event (FMCE), for any rejected MCE. The event simply wraps the original MCE and an error message, which contains the reason for rejection. This event can be used for debugging any potential ingestion issues, as well as for re-playing any previous rejected proposal if ever needed."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},"namespace com.linkedin.mxe\n\nimport com.linkedin.avro2pegasus.events.KafkaAuditHeader\n\n/**\n * Kafka event for capturing a failure to process a specific MCE\n */\nrecord FailedMetadataChangeEvent {\n\n  /** Kafka audit header */\n  auditHeader: optional KafkaAuditHeader\n\n  /** The even that failed to be processed */\n  metadataChangeEvent: MetadataChangeEvent\n\n  /** The error message or the stacktrace for the failure */\n  error: string\n}\n")),Object(o.b)("h2",{id:"metadata-audit-event-mae"},"Metadata Audit Event (MAE)"),Object(o.b)("p",null,"A Metadata Audit Event captures the change made to one or multiple metadata ",Object(o.b)("a",{parentName:"p",href:"/docs/what/aspect"},"aspects")," associated with a particular ",Object(o.b)("a",{parentName:"p",href:"/docs/what/entity"},"entity"),", in the form of a metadata ",Object(o.b)("a",{parentName:"p",href:"/docs/what/snapshot"},"snapshot")," before the change, and a metadata snapshot after the change."),Object(o.b)("p",null,'Every source-of-truth for a particular metadata aspect is expected to emit a MAE whenever a change is committed to that aspect. By ensuring that, any listener of MAE will be able to construct a complete view of the latest state for all aspects.\nFurthermore, because each MAE contains the "after image", any mistake made in emitting the MAE can be easily mitigated by emitting a follow-up MAE with the correction. By the same token, the initial bootstrap problem for any newly added entity can also be solved by emitting a MAE containing all the latest metadata aspects associated with that entity.'),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre"},"namespace com.linkedin.mxe\n\nimport com.linkedin.avro2pegasus.events.KafkaAuditHeader\nimport com.linkedin.metadata.snapshot.Snapshot\n\n/**\n * Kafka event for capturing update made to an entity's metadata.\n */\nrecord MetadataAuditEvent {\n\n  /** Kafka audit header */\n  auditHeader: optional KafkaAuditHeader\n\n  /**\n   * Snapshot of the metadata before the update. Set to null for newly created metadata. \n   * Only the metadata aspects affected by the update are included in the snapshot.\n   */\n  oldSnapshot: optional Snapshot\n\n  /**\n   * Snapshot of the metadata after the update. Only the metadata aspects affected by the \n   * update are included in the snapshot.\n   */\n  newSnapshot: Snapshot\n}\n")))}p.isMDXComponent=!0},159:function(e,t,a){"use strict";function n(){return(n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e}).apply(this,arguments)}a.d(t,"a",(function(){return n}))},160:function(e,t,a){"use strict";function n(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}a.d(t,"a",(function(){return n}))},161:function(e,t,a){"use strict";a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return m}));var n=a(0),r=a.n(n);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function c(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var d=r.a.createContext({}),p=function(e){var t=r.a.useContext(d),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},l=function(e){var t=p(e.components);return r.a.createElement(d.Provider,{value:t},e.children)},h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,d=c(e,["components","mdxType","originalType","parentName"]),l=p(a),u=n,m=l["".concat(i,".").concat(u)]||l[u]||h[u]||o;return a?r.a.createElement(m,s(s({ref:t},d),{},{components:a})):r.a.createElement(m,s({ref:t},d))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=u;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s.mdxType="string"==typeof e?e:n,i[1]=s;for(var d=2;d<o;d++)i[d]=a[d];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,a)}u.displayName="MDXCreateElement"}}]);